{{ block "authentication" . }}
<div class="auth-container">
    <div class="auth-box">
        <h2>Login to Course Management</h2>
        <p style="text-align: center; margin-bottom: 30px;">Sign in with your Google account</p>
        
        <!-- Google Sign-In Button -->
        <div id="g_id_onload"
             data-client_id="{{ .GoogleClientID }}"
             data-context="signin"
             data-ux_mode="popup"
             data-callback="handleCredentialResponse"
             data-auto_prompt="false">
        </div>
        
        <div class="g_id_signin" 
             data-type="standard"
             data-shape="rectangular"
             data-theme="outline"
             data-text="signin_with"
             data-size="large"
             data-logo_alignment="left">
        </div>
    </div>
</div>

<!-- Load Google Identity Services -->
<script src="https://accounts.google.com/gsi/client" async defer></script>

<script>
// Handle the credential response
function handleCredentialResponse(response) {
    console.log('üîê Google Sign-In successful');
    
    // Send the JWT token to your backend via HTMX
    htmx.ajax('POST', '/auth/google/verify', {
        values: { 
            credential: response.credential 
        },
        target: '#main-content'
    });
}

// Optional: Handle sign-in errors
window.addEventListener('load', function() {
    // Additional Google Sign-In configuration if needed
    console.log('üöÄ Google Identity Services loaded');
});
</script>

<style>
    .auth-container {
        display: flex;
        justify-content: center;
        align-items: center;
        min-height: 60vh;
        padding: 20px;
    }

    .auth-box {
        background-color: #B5D844;
        border-radius: 8px;
        padding: 40px;
        box-shadow: 0 4px 6px rgba(0,0,0,0.1);
        max-width: 400px;
        width: 100%;
        text-align: center;
    }

    .auth-box h2 {
        color: #204606;
        margin-bottom: 10px;
        font-size: 2em;
    }

    .auth-box p {
        color: #204606;
        margin-bottom: 30px;
    }

    /* Center the Google button */
    .g_id_signin {
        display: flex;
        justify-content: center;
        margin-top: 20px;
    }
</style>
{{ end }}

{{ block "user-profile" . }}
<div class="user-profile">
    <img src="{{.Picture}}" alt="{{.Name}}" class="profile-picture">
    <div class="user-info">
        <h3>{{.Name}}</h3>
        <p>{{.Email}}</p>
        <button hx-post="/auth/logout" hx-target="#main-content" class="logout-btn">
            Sign Out
        </button>
    </div>
</div>

<style>
    .user-profile {
        display: flex;
        align-items: center;
        gap: 15px;
        padding: 20px;
        background-color: rgba(181, 216, 68, 0.1);
        border-radius: 8px;
        margin: 20px 0;
    }
    
    .profile-picture {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        border: 3px solid #204606;
    }
    
    .user-info h3 {
        margin: 0;
        color: #204606;
        font-size: 1.2em;
    }
    
    .user-info p {
        margin: 5px 0;
        color: #666;
        font-size: 0.9em;
    }
    
    .logout-btn {
        background-color: #204606;
        color: white;
        border: none;
        padding: 10px 20px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 0.9em;
        transition: background-color 0.2s;
        margin-top: 10px;
    }
    
    .logout-btn:hover {
        background-color: #2d6509;
    }
</style>
{{ end }}
